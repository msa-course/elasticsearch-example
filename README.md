# Elasticsearch ‚Äì –ü—Ä–∏–º–µ—Ä—ã

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –ø–æ —Ç–µ–º–µ **¬´Elasticsearch –∫–∞–∫ NoSQL-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö¬ª**. 

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏.

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ —Å –º–∞–ø–ø–∏–Ω–≥–æ–º
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Ç–æ–≤–∞—Ä–æ–≤)
- –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ (`match`)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –±—É–ª–µ–≤—ã –∑–∞–ø—Ä–æ—Å—ã (`bool`, `filter`)
- –ê–≥—Ä–µ–≥–∞—Ü–∏–∏:
  - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ (`avg`)
  - –†–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ –±—Ä–µ–Ω–¥–∞–º (`terms`)
  - –ê–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º –ø–æ–ª—è–º
- –ü–æ–∏—Å–∫ –ø–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º (`nested`)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é (`function_score`)

## üõ† –ü—Ä–∏–º–µ—Ä –∫–µ–π—Å–∞

–†–∞–±–æ—Ç–∞–µ–º —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ:

```json
{
  "title": "–ù–æ—É—Ç–±—É–∫ Lenovo IdeaPad 3 15",
  "brand": "Lenovo",
  "category": "notebooks",
  "price": 45990,
  "in_stock": true,
  "rating": 4.6,
  "properties": [
    { "name": "–û–ó–£", "value": "8 –ì–ë" },
    { "name": "SSD", "value": "256 –ì–ë" }
  ]
}
```

## üöÄ –ó–∞–ø—É—Å–∫ Elasticsearch 8.7.0 + Kibana

```bash
docker compose up -d
```

## üßë‚Äçüíª –ó–∞–ø—Ä–æ—Å—ã

| ‚Ññ  | –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞                                              | –û–ø–∏—Å–∞–Ω–∏–µ                                    |
|----|-------------------------------------------------------------|---------------------------------------------|
| 1  | [`1_create_index.http`](./examples/1_create_index.http)     | –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ —Å –º–∞–ø–ø–∏–Ω–≥–æ–º                |
| 2  | [`2_index_document.http`](./examples/2_index_document.http) | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞                           |
| 2a | [`2a_index_with_id.http`](./examples/2a_index_with_id.http) | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º ID            |
| 2b | [`2b_index_bulk.http`](./examples/2b_index_bulk.http)       | –ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ (bulk API)      |
| 3  | [`3_search_match.http`](./examples/3_search_match.http)     | –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ç–æ–≤–∞—Ä–∞                    |
| 4  | [`4_search_filter.http`](./examples/4_search_filter.http)   | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ü–µ–Ω–µ –∏ –Ω–∞–ª–∏—á–∏—é                |
| 5  | [`5_agg_avg_price.http`](./examples/5_agg_avg_price.http)   | –ê–≥—Ä–µ–≥–∞—Ü–∏—è: —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞                     |
| 6  | [`6_agg_by_brand.http`](./examples/6_agg_by_brand.http)     | –ê–≥—Ä–µ–≥–∞—Ü–∏—è: —Ç–æ–≤–∞—Ä—ã –ø–æ –±—Ä–µ–Ω–¥–∞–º                |
| 7  | [`7_nested_search.http`](./examples/7_nested_search.http)   | –ü–æ–∏—Å–∫ –ø–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º (nested) |
| 8  | [`8_function_score.http`](./examples/8_function_score.http) | –ü–æ–≤—ã—à–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤               |

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Kibana (DevTools)

–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Kibana –≤ —Ä–∞–∑–¥–µ–ª–µ [DevTools](http://127.0.0.1:5601/app/dev_tools#/console) –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—Å—Ç–∞–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤, –Ω–µ —É–∫–∞–∑—ã–≤–∞—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏. 

–ü—Ä–∏–º–µ—Ä –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:

```json
POST /products/_doc
{
  "title": "–ù–æ—É—Ç–±—É–∫ Lenovo IdeaPad 3 15",
  "brand": "Lenovo",
  "category": "notebooks",
  "price": 45990,
  "in_stock": true,
  "rating": 4.6,
  "specs": [
    { "name": "–û–ó–£", "value": "8 –ì–ë" },
    { "name": "SSD", "value": "256 –ì–ë" }
  ]
}
```

## ‚öôÔ∏è –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

–í –ø–∞–ø–∫–µ `scripts` –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Å–∫—Ä–∏–ø—Ç—ã, —É–ø—Ä–æ—â–∞—é—â–∏–µ —Ä–∞–±–æ—Ç—É —Å Elasticsearch.

### –°–ø–∏—Å–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤


| –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞                                | –û–ø–∏—Å–∞–Ω–∏–µ                                                   |
|-------------------------------------------------|------------------------------------------------------------|
| [`reset_index.sh`](./scripts/reset_index.sh)    | –£–¥–∞–ª—è–µ—Ç –∏ –∑–∞–Ω–æ–≤–æ —Å–æ–∑–¥–∞—ë—Ç –∏–Ω–¥–µ–∫—Å `products` —Å –º–∞–ø–ø–∏–Ω–≥–æ–º     |
| [`status_check.sh`](./scripts/status_check.sh)  | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞             |



## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

* [Elasticsearch Documentation](https://www.elastic.co/docs/get-started)
* [Kibana Console](https://www.elastic.co/kibana)
* [Elasticsearch Query DSL](https://www.elastic.co/docs/explore-analyze/query-filter/languages/querydsl)
* [Laravel Elastic Query](https://github.com/ensi-platform/laravel-elastic-query)
* [Laravel Elastic Query Specification](https://github.com/ensi-platform/laravel-elastic-query-specification)